function API(){this.getWeather=function(e,t,a){$.get("./api/weather",{lat:e,lon:t},function(e){a(e)}).fail(function(e){a(e.responseJSON)})}}var api=new API,card1=$("#card1"),card2=$("#card2"),card2Text=$("#card2Text"),card2Title=$("#card2Title"),card3=$("#card3"),btnYesClicked=function(){card1.css({display:"none"}),card2.css({display:"block"}),getLocation(loadWeather)},btnRefreshClicked=function(){card3.css({display:"none"}),card2.css({display:"block"}),getLocation(loadWeather)},getLocation=function(e){navigator.geolocation?navigator.geolocation.getCurrentPosition(e,showError):(card2Title.text("Error"),card2Text.text("Geolocation is not supported on this browser."))},loadWeather=function(e){api.getWeather(e.coords.latitude,e.coords.longitude,function(e){200==e.status?(displayWeather(e.weatherData),card3.css({display:"block"}),card2.css({display:"none"})):showError(e.weatherData)})},showError=function(e){card2Title.text("Error"),$(".mdl-spinner").css({display:"none"}),card2Text.text(e.message),$(".mdl-card").css({width:"auto","max-width":"inherit"})},displayWeather=function(e){var t=new Date,a=t>convertTimestamp(e.sys.sunrise)&&t<convertTimestamp(e.sys.sunset),n="wi-owm-"+(a?"day-":"night-")+e.weather[0].id;$("#weatherIcon").addClass(n),$("#windIcon").addClass("towards-"+e.wind.deg+"-deg"),$("#wind").text((1e3*e.wind.speed/3600).toFixed(2)+"km/h"),$("#weather").text(e.weather[0].main),$("#temperature").html(e.main.temp.toFixed(2)+"&#8451;"),$("#cityName").text(e.name)},convertTimestamp=function(e){return new Date(1e3*e)};$("#btnYes").on("click",btnYesClicked),$("#btnRefresh").on("click",btnRefreshClicked);